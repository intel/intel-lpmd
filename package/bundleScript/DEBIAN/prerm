param=$1
if [ ! -z "$param" ]; then
	if [ $param = "purge" -o $param = "remove" ]; then
		pkgdir="/usr/share/ia_pkg/hepo"
		pkgfile="/usr/share/ia_pkg/hepo/pkg.opt.hepo.x86_64.tar.gz"

		if [ -n "$(ls $pkgdir/pkg.OPT.HEPO*)" ]; then
			cd $pkgdir/pkg.OPT.HEPO*
			sudo ./rollback.sh
			sleep 1
			rm -rf $pkgdir/pkg.OPT.HEPO*
			rm -rf $pkgdir
		fi
	fi
	if [ $param = "upgrade" ]; then
		if test -f /usr/sbin/tuned-adm; then
			output=$(echo $(tuned-adm active) | grep -o ":")
			if [ ! -z "$output" ]; then
				activeprofile=$(echo $(tuned-adm active) | cut -d ":" -f 2)
				if [ $activeprofile = "intel_hepo" ]; then
					sudo tuned-adm off
				fi
			fi
			sudo pkill -f intel_lpmd >/dev/null 2>&1 &
		else
			if test -f /usr/lib/systemd/system/intel_lpmd.service; then
				sudo systemctl stop intel_lpmd
			fi
		fi
	fi

fi


